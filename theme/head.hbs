<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F8Z6820M34"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    const gtagStartDate = new Date();
    gtag('js', gtagStartDate);
    const reqHeaders = new Headers();
    reqHeaders.set('Accept', 'application/json');
    fetch('https://ipinfo.io/', { method: 'GET', headers: reqHeaders})
        .then(async res => {
            if (!res.ok) return;
            const eventInfo = await res.json();
            gtag('config', 'G-F8Z6820M34', eventInfo);
        })
        .then(() => {
            setTimeout(() => { gtag('event', 'stayed_5_sec'); }, 5000);
            setTimeout(() => { gtag('event', 'stayed_30_sec'); }, 30000);
            setTimeout(() => { gtag('event', 'stayed_1_min'); }, 60000);
            setTimeout(() => { gtag('event', 'stayed_5_min'); }, 5 * 60000);
            window.addEventListener('beforeunload', () => { 
                gtag('event', 'leave_page', { 'stayed': Date.now() - gtagStartDate.valueOf() });
            });
        });
</script>
